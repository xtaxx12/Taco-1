{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Taco Home - Auténtica comida TEX-MEX con ingredientes frescos y recetas tradicionales">
    <meta name="keywords" content="tacos, burritos, comida mexicana, tex-mex, restaurante">
    <meta name="author" content="Taco Home">
    <meta name="theme-color" content="#FF6B35">

    <title>{% block title %}Taco Home - Sabor auténtico{% endblock %}</title>

    <!-- Icons -->
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- AOS Animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">

    <!-- Custom CSS - Nuevo Sistema Moderno -->
    <link rel="stylesheet" href="{% static 'css/variables.css' %}">
    <link rel="stylesheet" href="{% static 'css/modern-base.css' %}">
    <link rel="stylesheet" href="{% static 'css/modern-components.css' %}">
    <link rel="stylesheet" href="{% static 'css/modern-pages.css' %}">
    <link rel="stylesheet" href="{% static 'css/cart.css' %}">

    <!-- CSS Antiguo (Backup) -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Additional CSS for specific pages -->
    {% block extra_css %}{% endblock %}

</head>
<body>  
   <!-- Loading Spinner -->
   <div id="loading-spinner" class="loading-spinner">
       <div class="spinner"></div>
       <div class="loading-text">Cargando Taco Home...</div>
   </div>

   <!-- Header Moderno -->
   <header class="header" role="banner">
      <div class="header-container">
         <a href="{% url 'index' %}" class="logo">
            <img src="{% static 'images/logo.png' %}" alt="Taco Home Logo" loading="lazy">
            <span class="logo-text">Taco Home</span>
         </a>

         <nav class="navbar" role="navigation" aria-label="Navegación principal">
            <a href="{% url 'index' %}" {% if request.resolver_match.url_name == 'index' %}class="active"{% endif %}>
               <i class="fas fa-home"></i> Inicio
            </a>
            <a href="{% url 'menu' %}" {% if request.resolver_match.url_name == 'menu' %}class="active"{% endif %}>
               <i class="fas fa-utensils"></i> Menú
            </a>
            <a href="#contact">
               <i class="fas fa-envelope"></i> Contacto
            </a>
         </nav>

         <div class="header-actions">
            {% if user.is_authenticated %}
               <span class="user-greeting">¡Hola, {{ user.first_name|default:user.username }}!</span>
               <a href="{% url 'logout' %}" class="logout-btn" title="Cerrar sesión">
                  <i class="fas fa-sign-out-alt"></i>
               </a>
            {% else %}
               <a href="{% url 'login' %}" class="login-btn">
                  <i class="fas fa-user"></i> Iniciar Sesión
               </a>
            {% endif %}
            <button class="cart-btn" aria-label="Ver carrito de compras" title="Carrito de compras">
               <i class="fas fa-shopping-cart"></i>
               <span class="cart-count" style="display: none;">0</span>
            </button>
         </div>

         <button class="menu-toggle" aria-label="Abrir menú de navegación">
            <i class="fas fa-bars"></i>
         </button>
      </div>
   </header>

   <!-- Messages -->
   {% if messages %}
   <div class="messages-container">
      {% for message in messages %}
         <div class="alert alert-{{ message.tags }} alert-dismissible" role="alert">
            <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
            {{ message }}
            <button type="button" class="close" aria-label="Cerrar mensaje">
               <i class="fas fa-times"></i>
            </button>
         </div>
      {% endfor %}
   </div>
   {% endif %}

   <!-- Main Content -->
   <main role="main">
      {% block body %}
      {% endblock %}
   </main>

   <!-- Footer -->
   <footer class="footer" role="contentinfo">
      <div class="footer-content">
         <div class="footer-section">
            <h3>Taco Home</h3>
            <p>Auténtica comida TEX-MEX con ingredientes frescos y recetas tradicionales.</p>
            <div class="social-links">
               <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
               <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
               <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            </div>
         </div>
         
         <div class="footer-section">
            <h4>Contacto</h4>
            <p><i class="fas fa-map-marker-alt"></i> Ayacucho, entre 25 de Junio & Sucre</p>
            <p><i class="fas fa-phone"></i> +593 963410295</p>
            <p><i class="fas fa-envelope"></i> tacohome2011@gmail.com</p>
         </div>
         
         <div class="footer-section">
            <h4>Horarios</h4>
            <p>Lunes - Viernes: 11:00 AM - 10:00 PM</p>
            <p>Sábados: 12:00 PM - 11:00 PM</p>
            <p>Domingos: 12:00 PM - 9:00 PM</p>
         </div>
      </div>
      
      <div class="footer-bottom">
         <p>&copy; 2024 Taco Home. Todos los derechos reservados.</p>
      </div>
   </footer>

   <!-- Scripts -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
   <script src="{% static 'js/modern-app.js' %}"></script>
   <script src="{% static 'js/script.js' %}"></script>
   
   <script>
   document.addEventListener('DOMContentLoaded', function() {
      // Initialize AOS with enhanced settings
      AOS.init({
         duration: 800,
         once: true,
         offset: 100,
         easing: 'ease-out-cubic'
      });
      
      // Enhanced loading spinner
      const spinner = document.getElementById('loading-spinner');
      if (spinner) {
         // Simulate loading time for better UX
         setTimeout(() => {
            spinner.style.opacity = '0';
            setTimeout(() => {
               spinner.style.display = 'none';
               document.body.style.overflow = 'auto';
            }, 500);
         }, 1000);
      }
      
      // Mobile menu toggle with animation
      const menuBtn = document.getElementById('menu-btn');
      const navbar = document.querySelector('.navbar');
      
      if (menuBtn && navbar) {
         menuBtn.addEventListener('click', function() {
            navbar.classList.toggle('active');
            this.classList.toggle('active');
            
            // Animate hamburger icon
            const icon = this.querySelector('i');
            if (navbar.classList.contains('active')) {
               icon.className = 'fas fa-times';
            } else {
               icon.className = 'fas fa-bars';
            }
         });
         
         // Close menu when clicking outside
         document.addEventListener('click', function(e) {
            if (!menuBtn.contains(e.target) && !navbar.contains(e.target)) {
               navbar.classList.remove('active');
               menuBtn.classList.remove('active');
               menuBtn.querySelector('i').className = 'fas fa-bars';
            }
         });
      }
      
      // Enhanced message system
      const messages = document.querySelectorAll('.alert');
      messages.forEach((message, index) => {
         // Stagger animation
         message.style.animationDelay = `${index * 0.1}s`;
         message.classList.add('fadeInRight');
         
         // Auto-hide with progress bar
         const progressBar = document.createElement('div');
         progressBar.className = 'progress-bar';
         const progressFill = document.createElement('div');
         progressFill.className = 'progress-fill';
         progressBar.appendChild(progressFill);
         message.appendChild(progressBar);
         
         setTimeout(() => {
            message.style.opacity = '0';
            message.style.transform = 'translateX(100%)';
            setTimeout(() => message.remove(), 300);
         }, 5000);
      });
      
      // Close message buttons with ripple effect
      document.querySelectorAll('.alert .close').forEach(btn => {
         btn.classList.add('ripple-effect');
         btn.addEventListener('click', function() {
            this.parentElement.style.opacity = '0';
            this.parentElement.style.transform = 'translateX(100%)';
            setTimeout(() => this.parentElement.remove(), 300);
         });
      });
      
      // Enhanced smooth scroll
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
         anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
               const headerHeight = document.querySelector('.header').offsetHeight;
               const targetPosition = target.offsetTop - headerHeight - 20;
               
               window.scrollTo({
                  top: targetPosition,
                  behavior: 'smooth'
               });
            }
         });
      });
      
      // Enhanced header scroll effect
      const header = document.querySelector('.header');
      let lastScrollTop = 0;
      let ticking = false;
      
      function updateHeader() {
         const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
         
         if (scrollTop > 100) {
            header.classList.add('scrolled');
         } else {
            header.classList.remove('scrolled');
         }
         
         if (scrollTop > lastScrollTop && scrollTop > 200) {
            // Scrolling down
            header.style.transform = 'translateY(-100%)';
         } else {
            // Scrolling up
            header.style.transform = 'translateY(0)';
         }
         
         lastScrollTop = scrollTop;
         ticking = false;
      }
      
      window.addEventListener('scroll', function() {
         if (!ticking) {
            requestAnimationFrame(updateHeader);
            ticking = true;
         }
      });
      
      // Parallax effect for hero section
      const hero = document.querySelector('.hero');
      if (hero) {
         window.addEventListener('scroll', function() {
            const scrolled = window.pageYOffset;
            const parallax = hero.querySelector('.hero-image');
            if (parallax) {
               const speed = scrolled * 0.5;
               parallax.style.transform = `translateY(${speed}px)`;
            }
         });
      }
      
      // Add ripple effect to buttons
      document.querySelectorAll('.btn-primary, .btn-secondary, .cart-btn').forEach(btn => {
         btn.classList.add('ripple-effect');
      });
      
      // Counter animation for statistics
      function animateCounters() {
         const counters = document.querySelectorAll('.counter');
         counters.forEach(counter => {
            const target = parseInt(counter.getAttribute('data-target'));
            const count = +counter.innerText;
            const increment = target / 200;
            
            if (count < target) {
               counter.innerText = Math.ceil(count + increment);
               setTimeout(() => animateCounters(), 1);
            } else {
               counter.innerText = target;
            }
         });
      }
      
      // Intersection Observer for animations
      const observerOptions = {
         threshold: 0.1,
         rootMargin: '0px 0px -50px 0px'
      };
      
      const observer = new IntersectionObserver(function(entries) {
         entries.forEach(entry => {
            if (entry.isIntersecting) {
               entry.target.classList.add('animate');
               
               // Trigger counter animation
               if (entry.target.classList.contains('stats-section')) {
                  animateCounters();
               }
            }
         });
      }, observerOptions);
      
      // Observe elements for animation
      document.querySelectorAll('.feature-card, .info-card, .stats-section').forEach(el => {
         observer.observe(el);
      });
      
      // Add floating particles to hero section
      function createParticles() {
         const hero = document.querySelector('.hero');
         if (hero) {
            const particlesContainer = document.createElement('div');
            particlesContainer.className = 'floating-particles';
            
            for (let i = 0; i < 20; i++) {
               const particle = document.createElement('div');
               particle.className = 'particle';
               particle.style.left = Math.random() * 100 + '%';
               particle.style.animationDelay = Math.random() * 6 + 's';
               particlesContainer.appendChild(particle);
            }
            
            hero.appendChild(particlesContainer);
         }
      }
      
      createParticles();
      
      // Enhanced form validation
      const forms = document.querySelectorAll('form');
      forms.forEach(form => {
         const inputs = form.querySelectorAll('input, textarea');
         
         inputs.forEach(input => {
            input.addEventListener('focus', function() {
               this.parentElement.classList.add('focused');
            });
            
            input.addEventListener('blur', function() {
               if (!this.value) {
                  this.parentElement.classList.remove('focused');
               }
            });
            
            input.addEventListener('input', function() {
               if (this.value) {
                  this.parentElement.classList.add('has-value');
               } else {
                  this.parentElement.classList.remove('has-value');
               }
            });
         });
      });
   });
   </script>
   
   {% block extra_js %}{% endblock %}
    
</body>
</html>

<style>
   body {
   background: url("{% static '/images/background.jpeg' %}");
   background-attachment: fixed;
   background-position: center;
   overflow-x: hidden;
   display: flex;
   flex-direction: column;
   min-height: 100vh; /* Asegura que el cuerpo ocupe al menos el 100% del alto de la ventana */
   margin: 0;
   }

   .home {
   margin-top: 7rem;
   background: url("{% static '/images/home-bg.png' %}") no-repeat;
   filter: drop-shadow(10px 10px 10px rgba(0,0,0,0.50));
   background-size: cover;
   background-position: center;
   }
</style>